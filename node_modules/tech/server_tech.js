var db = require('db');
var config = require('config');

var stdin = process.openStdin();

/**
 * Module for special commands, which can be entered
 * directly while the server is running
 */

module.exports = stdin.addListener("data", function (d) {
    var s = d.toString().trim();
    switch (s) {
        case "DELETE UDB":
            db.users.deleteAllUsers();
            console.log("USERS DB is deleted");
            break;
        case "DELETE SDB":
            db.sessions.deleteAllSessions();
            console.log("SESSIONS DB is deleted");
            break;
        case "CREATE TU": //creating test user "admin""admin"
            db.users.deleteAllUsers();
            db.users.addUser("admin", "admin").then().catch();
            console.log("User created");
            break;
        case "CLEAN":
            db.sessions.deleteAllSessions();
            db.users.deleteAllUsers();
            db.users.addUser("admin", "admin").then().catch();
            console.log("Cleaned up");
            break;
        default:
            console.log("No such command");
            break;
    }
});